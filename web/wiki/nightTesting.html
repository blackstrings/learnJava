<html>
<head>
	<script data-main="js/mainWiki" src="js/lib/require.js"></script>
	<title></title>
	<script>
		//if you call it explicitly like this, you have to call the common configs again so your file path will stay relative
		require(['./commonWiki'], function (common) {
			require(["jquery", "app/wikiUtils"], function($, utils){
				$(function() {
					utils.setMainWebTitle("Nightly Testing");
				});
			});
		});
	</script>
</head>

<body>

<div id="contents">

	<section>
		<h1>Rolling Deployment</h1>
		<p>There are two types of deployment for our web apps. Rolling and nightly deployments.When Siding or Roofing only has data changes and no media changes, then we can do rolling deployment, which means we can roll the app nation wide during the day</p>
		<section>
			<h1>Rolling deployment test</h1>
			<ul>
				<li>Rolling deployment is done during the day at your PC while you are still at work</li>
				<li>When time comes, you shut down one server, make the deployment, and turn it back on</li>
				<li>Test your MCR to ensure the app works</li>
				<li>rinse repeat to next web app</li>
			</ul>
		</section>
		<section>
			<h1>Night Deployment Test (Can test from home if you have the token as we are testing prod links)</h1>
			<p>At this point our apps have gone through dev testing, stage testing, and is now ready to be put into the stores.
			Basically when our web apps have media changes, the apps can only be rolled out to the store at night,
			because that's when no one is using it. The team lead sends the pacakge to a server and the server will deploy the app automatically for us 
			during the 11pm mark. Due to that case, developers (that's us) only need to test the night deployment not have to worry about deploying it. 
			Someone will have to come in at 11 (can be at home if have token) and wait for the email deployment notification before they can test the web apps. 
			We need to test the app right then because we need to ensure the apps are working for the morning.
			</p>
			
			
			<p>
			If the production (Prod) links don't work, we have to resolve it by calling the oncall people and talk to them (networking). They will do their server magic and have you test again. In worse case if nothing can be done, we will have to wait till morning
			</p>
			
			<h2>How to test nightly deployment</h2>
			<ul>
				<li>Basically just run the web apps and make a printout and ensure you don't get 500 error screens.</li>
				<li>Wait till you get deployment email, look for the roofing.war or siding.war email, thats' when you can test that app</li>
				<li>The deployment flow is - The data gets deployed, followed by the media, followed by the war files. that's why we wait for war files</li>
				<li>Usually if you don't get an email about the war files, wait until 11:15 to be safe to start testing</li>
				<li>Go to the kiosk links > go to the app you need to test (Roofing or Siding or Both) > (but one at a time) click on Prod LB and not the individual serves</li>
				<li>Run the App MCR test cases using Redmine, under (ex: under Q1R1) and see that it doesn't crash or act weird, so you would test all roofing/siding MCR for that release</li>
				<li>If you were only told to test Roofing, just worry about testing that app</li>
				<li>You don't have to test every case, just test quickly as if you were to test at store, make sure to print</li>
				<li>If all testing pass, don't do anything to the MCR, just email Team Lead and tell them nightly deployment testing passed</li>
			</ul>
			
			<h2>Trouble shooting</h2>
			<p>If you click on the kiosk url and you just get the spinning circle in the tab, then it means the kiosk url server is down (not the mcom production server), and you'll have to restart the kiosk url server.
			To restart server: you'll need mtPutty (a wrapper around putty).
			</p>
			
			<h2>Kiosk Url not working? Need to restart server for kiosk url? but no mtPutty, use the shorcut links below instead -- but these are only for siding and roofing</h2>
			<ul>
				<h3>Roofing</h3>
				<li>Stage | <a href="http://stage-kiosk.mymenards.com/RoofingEstimator/screen1102.do?dispatch=restart&selection(storeNumber)=3011" target="_blank">LB</a> | 
						<a href="http://kiosk-stage1-app-kvm:8080/RoofingEstimator/screen1102.do?dispatch=restart&selection(storeNumber)=3011" target="_blank">A1</a> |
						<a href="http://kiosk-stage2-app-kvm:8080/RoofingEstimator/screen1102.do?dispatch=restart&selection(storeNumber)=3011" target="_blank">A2</a></li>
				</li>
				<li>Prod | <a href="http://design-it.mymenards.com/RoofingEstimator/screen1102.do?dispatch=restart&selection(storeNumber)=3011" target="_blank">LB</a> |
						<a href="http://kiosk-app1-kvm:8080/RoofingEstimator/screen1102.do?dispatch=restart&selection(storeNumber)=3011" target="_blank">A1</a> |
						<a href="http://kiosk-app2-kvm:8080/RoofingEstimator/screen1102.do?dispatch=restart&selection(storeNumber)=3011" target="_blank">A2</a>
				</li>
				<h3>Siding</h3>
				<li>Stage | <a href="http://stage-kiosk.mymenards.com/SidingEstimator/screen1100.do?dispatch=restart&selection(storeNumber)=3011" target="_blank">LB</a> | 
						<a href="http://kiosk-stage1-app-kvm:8080/SidingEstimator/screen1100.do?dispatch=restart&selection(storeNumber)=3011" target="_blank">A1</a> |
						<a href="http://kiosk-stage2-app-kvm:8080/SidingEstimator/screen1100.do?dispatch=restart&selection(storeNumber)=3011" target="_blank">A2</a></li>
				</li>
				<li>Prod | <a href="http://design-it.mymenards.com/SidingEstimator/screen1100.do?dispatch=restart&selection(storeNumber)=3011" target="_blank">LB</a> |
						<a href="http://kiosk-app1-kvm:8080/SidingEstimator/screen1100.do?dispatch=restart&selection(storeNumber)=3011" target="_blank">A1</a> |
						<a href="http://kiosk-app2-kvm:8080/SidingEstimator/screen1100.do?dispatch=restart&selection(storeNumber)=3011" target="_blank">A2</a>
				</li>
			</ul>
			
			<h2>Other ways to access kiosk url page which is also on the server instance of another TM's PC</h2>
			<p>
			<a href="http://10.3.44.157:8080/KioskUrls/index.html" target="_blank">Brian's Kiosk Url</a> to ping if this pc is up cmd ping 10.3.44.157
			</p>
		
		</section>
		
		<section>
			<h1>Patch Testing - Stage</h1>
			<p>Stage patching happens before prod patching. Stage is loaded sunday but we don't have to come in to test on sunday. 
			We can wait till later in the week during a week day. The process is still same as the prod testing, except we can test it whenever during our work period. 
			We do have to wait for the TL to assign us the redmine patch testing ticket. 
			Usually we run the stage kiosk URL, rung roofing and siding using the stage LB link, and make sure they don't crash and can run normal all the way to print. 
			For landscape vizualizer, use the "webInt" link not jboss, and we usually just do a recall and see if the recall works and can print. Assign back the ticket to team lead</p>
		</section>
		
		<section>
			<h1>Patch testing - Prod</h1>
			<p>Two types of testing: MySQL or JBoss</p>
			<ul>
				<li>Usually the on-call person comes to test this around 9 PM, not 11 PM like nightly deploy testing.</li>
				<li>Basically just check the correct App Server for the web apps like roofing, siding, and landscape visualizer and run through wihthout crashing, no MCRs to test against for patch testing</li>
				<li>You were suppose to be given notice on what App Server to test, i.e. A1 or A2, if not, Use the LB link under prod for each app (Siding, Roofing, landscape Visualizer = use jBoss link)</li>
				<li>If you get 503 error while running siding/roofing after a page or two, wait a bit and try again, or contact networking on-call at 828-4669</li>
				<li>Eventually a 503 error resovles itself in last case after 15 min, if not, contact the patch testers who emailed you to test and tell them you are having issues</li>
				<li>If you are asked to provide server IP you are testing, run the LB link for that app, (you'll be taken to the app page, bring up command prompt and ping the url app design-it.mymenards.com without the http or www, give them the pinged ip something like 10.4.250.27</li>
				<li>Usually testing through siding,roofing,visualizer just takes 15 minutes but come 30 minutes ahead of time.</li>
				<li>You begin testing when you get the On-call or email. If at work around 9 am, check your email. If at home, you'll be getting a phone call</li>
				<li>If you don't hav VPN, you should be at work</li>
				<li>You have to respond by email if you get the email and let the sender know you are testing the patch</li>
				<li>When you are done testing, email back to the sender and CC team lead and manager that patch testing passed also pass back Patch MCR to TL and comment in there too, you are then free to leave</li>
				<li>If problems arise, let the patcher know you are having issues and try to fix it before you leave for the night</li>
			</ul>
			<p>Special Testing</p>
			<p>Sometimes there is a special testing case. This will have instructions to follow</p>
			<p>You will have to test the JBoss A1 or A2 (app1 app2) depending on what server you are to test against, which the patcher releaser will email you the info</p>
		</section>
		
		<section>
			<h1>EAI Deployment - Prod</h1>
			<p>How to know if Roofing or Siding is setup for nightly deployment in advance</p>
			<ul>
				<li>When we need to do nightly deployment, TL sets up a EAI deployment.</li>
				<li>We should then see this in the email <img src="images/nightlyDeployment-1.png" width="100%" />  <br>The name for our designit it will be koskCluster.</li>
				<li>visit <a href="http://om-eai2/dotproject/index.php?dotproject=f7b422939d645df3bbdc34e95fb44a29">LINK HERE</a> to login</li>
				<li>refer to acc for loging credentials</li>
				<li>Scheduled Deployment > view scheduled prod deployements > check tab "Pending" or "Approved" > you should see status of a link in approved mode</li>
				<li>If you don't see anything, then roofing or siding isn't setup and will not be deployed at 11pm</li>
			</ul>
		
		</section>
		
		
	</section>
	
</div>
</body>
</html>